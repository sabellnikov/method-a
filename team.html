---
layout: default
---

{% assign fast_link = '
      rounded-full px-5 py-1 sm:py-2 bg-[#FD589E] text-[#38001B] font-semibold text-sm sm:text-base transition-colors duration-200 hover:bg-[#38001B] hover:text-[#FD589E] text-center
' %}

<div class="slide-section flex-col" data-bg="var(--color-background-top)">
  <div class="relative px-4 sm:px-12">
    <div class="flex flex-wrap gap-2 sm:gap-4 mt-28 sm:mt-40 items-stretch gap-y-2 sm:gap-y-2">
      <a href="#about" class="{{ fast_link }}">О бюро</a>
      <a href="#media" class="{{ fast_link }}">СМИ</a>
      <a href="#team" class="{{ fast_link }}">Команда</a>
      <a href="#vacancies" class="{{ fast_link }}">Вакансии</a>
    </div>
    <h1 class="text-4xl md:text-8xl font-medium mt-[8vh] sm:mt-[12vh] max-w-7xl">Вместе делаем результаты для вас!</h1>
  </div>

  <div class="flex justify-center items-center mt-[8vh] sm:mt-[16vh]">
    <!-- Внешняя обёртка для pin -->
    <div id="videoPinWrapper" class="w-full flex justify-center">
      <div id="videoContainer" class="relative w-[80vw] h-[80vw] max-w-full box-border sm:w-[85vw] sm:h-auto sm:aspect-[16/9] sm:max-h-none">
        <video id="teamVideo" class="object-cover w-full h-full rounded-3xl" preload="metadata">
          <source src="/resources/team/about.mp4" type="video/mp4">
          Ваш браузер не поддерживает видео.
        </video>
        <button id="playBtn" class="absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 flex items-center justify-center transition rounded-2xl"
          style="border:none;outline:none;">
          <svg width="80" height="80" viewBox="0 0 80 80" fill="none">
            <circle cx="40" cy="40" r="40" fill="#FD589E" fill-opacity="0.95"/>
            <polygon points="32,25 60,40 32,55" fill="#38001B"/>
          </svg>
        </button>
      </div>
    </div>
    <div id="videoPlaceholder" style="width:0;height:0;"></div>
  </div>

  <div id="about" class="relative md:px-32">
    <h1 class="text-4xl md:text-7xl font-medium mt-[140vh]" style="color: #0F1D07;">Наша история</h1>


    <!-- GSAP CDN -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/gsap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/ScrollTrigger.min.js"></script>
    <!-- <script src="/resources/js/markers.js"></script> -->
  </div>
</div>





<script>
  const video = document.getElementById('teamVideo');
  const playBtn = document.getElementById('playBtn');
  const videoContainer = document.getElementById('videoContainer');
  const videoPlaceholder = document.getElementById('videoPlaceholder');

  function isMobile() {
    return window.matchMedia('(max-width: 640px)').matches;
  }

  function setPlaceholderHeight() {
    if (isMobile()) {
      const rect = videoContainer.getBoundingClientRect();
      videoPlaceholder.style.height = rect.height + "px";
      videoPlaceholder.style.width = rect.width + "px";
    }
  }

  function resetPlaceholderHeight() {
    videoPlaceholder.style.height = "0";
    videoPlaceholder.style.width = "0";
  }

  playBtn.addEventListener('click', function() {
    setTimeout(() => {
      video.play();
    }, 100);
    playBtn.style.display = 'none';
  });

  video.addEventListener('pause', function() {
    playBtn.style.display = '';
    if (isMobile()) {
      videoContainer.classList.remove('video-fullscreen-mobile');
      resetPlaceholderHeight();
    }
  });

  video.addEventListener('play', function() {
    if (isMobile()) {
      setPlaceholderHeight();
      videoContainer.classList.add('video-fullscreen-mobile');
    }
    playBtn.style.display = 'none';
  });

  video.addEventListener('ended', function() {
    if (isMobile()) {
      videoContainer.classList.remove('video-fullscreen-mobile');
      resetPlaceholderHeight();
    }
  });

  video.addEventListener('click', function() {
    if (isMobile()) {
      if (!video.paused) {
        video.pause();
      } else {
        setTimeout(() => {
          video.play();
        }, 100);
      }
    } else {
      if (video.paused) {
        setTimeout(() => {
          video.play();
        }, 100);
      } else {
        video.pause();
      }
    }
  });

  // На мобильных устройствах: клик по любому месту контейнера — пауза
  if (isMobile()) {
    videoContainer.addEventListener('click', function(e) {
      // Если клик был не по кнопке play и не по самому видео
      if (e.target !== video && e.target !== playBtn) {
        if (!video.paused) {
          video.pause();
        }
      }
    });
  }

  // GSAP video expand on scroll
  document.addEventListener('DOMContentLoaded', function() {
    if (window.gsap && window.ScrollTrigger) {
      gsap.registerPlugin(ScrollTrigger);

      if (!isMobile()) {
        // Pin-анимация на внешней обёртке
        ScrollTrigger.create({
            trigger: "#videoPinWrapper",
            start: "center center",
            end: () => `+=${window.innerHeight * 1.5}`,
            pin: true,
            pinSpacing: true,
            markers: false,
            scrub: false
        });

        // Анимация ширины только на внутреннем контейнере
        gsap.to("#videoContainer", {
          scrollTrigger: {
            trigger: "#videoPinWrapper",
            start: "top center",
            end: () => {
              const container = document.getElementById('videoPinWrapper');
              return `bottom+=${window.innerHeight * 0.4} center`;
            },
            scrub: true,
            markers: false
          },
          width: "97.5vw",
          maxWidth: "97.5vw",
          borderRadius: "0.5rem",
          ease: "expoScale(1,2,power2.inOut)",
          duration: 1,
          yoyo: true,
          repeat: 1
        });
      }
    }

    // Fade-in animation for main content
    document.querySelector('.slide-section').classList.add('fade-in');
  });
</script>