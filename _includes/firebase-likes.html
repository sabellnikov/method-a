<div class="likes-container flex items-center space-x-2 mt-4">
  <button id="like-btn" class="flex items-center space-x-2 px-4 py-2 rounded-lg bg-[var(--color-nav-bg)] hover:bg-[var(--color-custom-hover)] transition-colors">
    <svg class="heart-icon" width="20" height="20" fill="none" viewBox="0 0 24 24">
      <path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
    </svg>
    <span id="like-count">0</span>
  </button>
</div>

<script type="module">
  // Firebase configuration - ЗАМЕНИТЕ НА ВАШУ КОНФИГУРАЦИЮ
  // 1. Откройте https://console.firebase.google.com/
  // 2. Выберите ваш проект
  // 3. Нажмите на шестеренку (Settings) → Project settings
  // 4. Прокрутите вниз до раздела "Your apps"
  // 5. Если нет веб-приложения - нажмите на иконку </> и создайте его
  // 6. Скопируйте объект firebaseConfig из кода
  
  const firebaseConfig = {
  apiKey: "AIzaSyBXGSRKZ78Vqz2qt-hog-xRvhVyBjoN3X4",
  authDomain: "method-a.firebaseapp.com",
  projectId: "method-a",
  storageBucket: "method-a.firebasestorage.app",
  messagingSenderId: "131611387185",
  appId: "1:131611387185:web:bb6ce2cfe0dfdb0e4efc10"
  };

  // Import Firebase modules
  import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.7.0/firebase-app.js';
  import { getDatabase, ref, get, set, increment, onValue } from 'https://www.gstatic.com/firebasejs/10.7.0/firebase-database.js';

  // Initialize Firebase
  const app = initializeApp(firebaseConfig);
  const db = getDatabase(app);

  // Get post ID from current page URL
  const postId = window.location.pathname.replace(/\//g, '-').replace(/^-/, '').replace(/-$/, '') || 'home';
  
  const likesRef = ref(db, `likes/${postId}`);
  const likeBtn = document.getElementById('like-btn');
  const likeCount = document.getElementById('like-count');
  const heartIcon = document.querySelector('.heart-icon path');

  // Load current likes count
  onValue(likesRef, (snapshot) => {
    const count = snapshot.val() || 0;
    likeCount.textContent = count;
  });

  // Check if user already liked (using localStorage)
  const hasLiked = localStorage.getItem(`liked-${postId}`) === 'true';
  if (hasLiked) {
    heartIcon.setAttribute('fill', 'currentColor');
    likeBtn.classList.add('text-red-500');
  }

  // Handle like button click
  likeBtn.addEventListener('click', async () => {
    const alreadyLiked = localStorage.getItem(`liked-${postId}`) === 'true';
    
    if (!alreadyLiked) {
      // Add like
      await set(likesRef, increment(1));
      localStorage.setItem(`liked-${postId}`, 'true');
      
      // Update UI
      heartIcon.setAttribute('fill', 'currentColor');
      likeBtn.classList.add('text-red-500');
      
      // Animate heart
      likeBtn.style.transform = 'scale(1.2)';
      setTimeout(() => {
        likeBtn.style.transform = 'scale(1)';
      }, 200);
    }
  });
</script>

<style>
  .likes-container button {
    transition: transform 0.2s ease;
  }
  
  .likes-container button:hover {
    transform: translateY(-1px);
  }
</style>
