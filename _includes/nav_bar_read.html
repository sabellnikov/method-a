{% assign class-link = 'class="
  font-semibold rounded-full hover:bg-[var(--color-custom-hover)] py-1 text-center whitespace-nowrap px-2 text-sm sm:text-base transition-colors bg-fade
  "' %}


<div class="fixed left-1/2 -translate-x-1/2 bottom-4 z-50 sm:top-4 sm:bottom-auto w-full max-w-4xl w-sm sm:w-full px-10 sm:px-40">
  <div id="nav-bar" class="flex h-10 sm:h-12 rounded-full items-center justify-between px-5 w-full z-50 shadow-xs bg-[var(--color-nav-bg)]">
    
    <!-- Кнопка "назад" -->
    <button onclick="goToPreviousPage()" {{ class-link }}>
      <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="none" viewBox="0 0 24 24">
        <path d="M19 12H5M5 12l7 7M5 12l7-7" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
      </svg>
    </button>

    <!-- Кнопка "Содержание" -->
    {% if content contains '<h' %}
      <div class="flex-1 flex justify-center">
        <button id="dropdownButton" type="button" {{ class-link }} >
          СОДЕРЖАНИЕ
        </button>
      </div>
    {% else %}
      <span class="flex-1 flex justify-center text-sm opacity-60">СОДЕРЖАНИЯ НЕТ</span>
    {% endif %}

    <!-- Блок действий справа -->
    {% if page.category == "case" %}
      <div class="flex items-center space-x-1">
        <button
          id="heart-btn"
          {{ class-link }}
          onclick="toggleHeart(this)">
          <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" viewBox="0 0 24 24">
            <path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"/>
          </svg>
        </button>
      </div>
    {% else %}
      <!-- для реад -->
      gg
    {% endif %}
  </div>
</div>

{% if page.category == "case" %}
  <div id="heartModal" class="modal-overlay" onclick="closeModal()">
    <div class="modal-content" onclick="event.stopPropagation()">
      <div style="font-size: 3rem; margin-bottom: 1rem;">❤️</div>
      <h3 style="margin-bottom: 1rem; color: #333;">Спасибо за лайк!</h3>
      <p style="color: #666; margin-bottom: 1.5rem;">Ваша очень важна для нас</p>
      <button onclick="closeModal()" style="background: #ef4444; color: white; border: none; padding: 0.5rem 1.5rem; border-radius: 8px; cursor: pointer;">
        Закрыть
      </button>
    </div>
  </div>
{% else %}
  <!-- для реад -->
{% endif %}

<!-- Выпадающая панель вне навбара -->
<div id="dropdownPanel" class="hidden" style="position:fixed; left:0; top:0; width:100vw; z-index:9999;">
  <div class="fixed left-1/2 -translate-x-1/2 bottom-18 z-50 sm:top-18 sm:bottom-auto w-full max-w-4xl w-sm sm:w-full px-10 sm:px-40 pointer-events-none">
    <div class="flex rounded-3xl items-center justify-center px-5 w-full z-50 shadow-xs bg-[var(--color-nav-bg)] pointer-events-auto">
      <div class="p-1 flex flex-col w-full">
        {% assign headings = content | split: '<h' %}
        {% for heading in headings %}
          {% if forloop.first == false %}
            {% assign heading_parts = heading | split: '>' %}
            {% if heading_parts.size > 1 %}
              {% assign heading_rest = heading_parts[1] %}
              {% assign heading_content = heading_rest | split: '</h' | first | strip_html | strip %}
              {% if heading_content != '' %}
                {% assign heading_id = heading_content | slugify %}
                <a href="#{{ heading_id }}" class="block w-full px-4 py-2 text-sm text-center hover:bg-[var(--color-custom-hover)] rounded-full m-1 transition-colors duration-200 no-underline focus:bg-[var(--color-custom-hover)] focus:outline-none bg-fade">{{ heading_content }}</a>
              {% endif %}
            {% endif %}
          {% endif %}
        {% endfor %}
      </div>
    </div>
  </div>
</div>